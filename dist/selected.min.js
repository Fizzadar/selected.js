(function(){"use strict";var selected={textWidth:0};selected.create=function(select){var container=document.createElement("div"),searchBox=document.createElement("input"),activeList=document.createElement("ul"),optionsList=document.createElement("ul"),options=select.querySelectorAll("option"),multiple=select.multiple||false;container.className=select.className;container.classList.add("selected");if(multiple)container.classList.add("selected-multiple");else container.classList.add("selected-single");optionsList.className="selected-options";activeList.className="selected-active";select.style.display="none";optionsList.style.display="none";var moveOptionList=function(){optionsList.style.marginTop=activeList.offsetHeight+"px";optionsList.style.width=activeList.offsetWidth+"px"};var onFocus=function(){optionsList.style.display="block";activeList.classList.add("focus")};container.addEventListener("click",function(ev){if(!activeList.classList.contains("focus")){onFocus();moveOptionList();searchBox.focus()}});searchBox.addEventListener("focus",function(ev){onFocus()});searchBox.addEventListener("blur",function(ev){optionsList.style.display="none";activeList.classList.remove("focus")});container.addEventListener("mousedown",function(ev){ev.preventDefault()});optionsList.addEventListener("mousedown",function(ev){ev.preventDefault()});var filterSearch=function(ev){var regex=new RegExp(searchBox.value,"i"),targets=optionsList.querySelectorAll("li");for(var i=0;i<targets.length;i++){var target=targets[i];if(multiple&&target.classList.contains("active"))continue;if(!target.textContent.match(regex)){target.style.display="none"}else{target.style.display="block"}}searchBox.style.width=searchBox.value.length*selected.textWidth+25+"px";moveOptionList()};searchBox.addEventListener("keyup",filterSearch);var createDeselected=function(option,selected){var item=document.createElement("li");item.textContent=option.textContent;var activate=function(){if(multiple){item.style.display="none"}else{for(var i=0;i<options.length;i++){if(options[i]._deselected)options[i]._deselected.classList.remove("active")}}item.classList.add("active")};item.addEventListener("click",function(ev){activate();selectOption(option)});if(selected){activate()}optionsList.appendChild(item);option._deselected=item};var selectOption=function(option){option.selected=true;if(searchBox.value&&searchBox.value!==""){searchBox.value="";filterSearch()}var item=document.createElement("li");item.textContent=option.textContent;if(multiple){item.addEventListener("click",function(ev){ev.stopPropagation();activeList.removeChild(item);deselectOption(option)});item.addEventListener("mousedown",function(ev){ev.preventDefault()});activeList.insertBefore(item,searchBox)}else{activeList.innerHTML="";activeList.appendChild(item)}if(!option._deselected){createDeselected(option,true)}moveOptionList()};var deselectOption=function(option){option.selected=false;if(option._deselected){option._deselected.style.display="block";option._deselected.classList.remove("active")}else{createDeselected(option)}if(searchBox.value&&searchBox.value!==""){filterSearch()}moveOptionList()};if(multiple)activeList.appendChild(searchBox);else optionsList.appendChild(searchBox);container.appendChild(optionsList);container.appendChild(activeList);select.parentNode.insertBefore(container,select);for(var j=0;j<options.length;j++){var option=options[j];option.selected?selectOption(option):deselectOption(option)}};selected.init=function(selector){var textWidthTester=document.createElement("div");textWidthTester.style.visibility="hidden";textWidthTester.style.float="left";textWidthTester.textContent="m";document.body.appendChild(textWidthTester);selected.textWidth=textWidthTester.offsetWidth;document.body.removeChild(textWidthTester);selector=selector||".selected";var selects=document.querySelectorAll("select"+selector);for(var i=0;i<selects.length;i++){this.create(selects[i])}};if(typeof module!="undefined")module.exports=selected;else window.selected=selected})();